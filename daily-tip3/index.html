<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Daily tip 03 | yuicer</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="https://img.yuicer.com/me.config/me.png">
    <meta name="description" content="colorful wanted">
    
    <link rel="preload" href="/assets/css/0.styles.9d116826.css" as="style"><link rel="preload" href="/assets/js/app.0958dc5d.js" as="script"><link rel="preload" href="/assets/js/4.5b843dec.js" as="script"><link rel="preload" href="/assets/js/5.4f7e8107.js" as="script"><link rel="preload" href="/assets/js/23.4e23238e.js" as="script"><link rel="prefetch" href="/assets/js/1.84fdeac6.js"><link rel="prefetch" href="/assets/js/10.f47326a2.js"><link rel="prefetch" href="/assets/js/11.015673ec.js"><link rel="prefetch" href="/assets/js/12.35cf854d.js"><link rel="prefetch" href="/assets/js/13.0cb0bd13.js"><link rel="prefetch" href="/assets/js/14.2a2cd11b.js"><link rel="prefetch" href="/assets/js/15.3932639a.js"><link rel="prefetch" href="/assets/js/16.a950256a.js"><link rel="prefetch" href="/assets/js/17.f38da1f2.js"><link rel="prefetch" href="/assets/js/18.82e81f40.js"><link rel="prefetch" href="/assets/js/19.467d18e1.js"><link rel="prefetch" href="/assets/js/20.ea1eeb89.js"><link rel="prefetch" href="/assets/js/21.dce4b66a.js"><link rel="prefetch" href="/assets/js/22.a4cb4010.js"><link rel="prefetch" href="/assets/js/24.ca52664f.js"><link rel="prefetch" href="/assets/js/25.cd0186b7.js"><link rel="prefetch" href="/assets/js/26.8631edec.js"><link rel="prefetch" href="/assets/js/27.d00edefa.js"><link rel="prefetch" href="/assets/js/28.ebb5853f.js"><link rel="prefetch" href="/assets/js/29.27a4411f.js"><link rel="prefetch" href="/assets/js/30.65f837b1.js"><link rel="prefetch" href="/assets/js/31.4201373b.js"><link rel="prefetch" href="/assets/js/32.e2683603.js"><link rel="prefetch" href="/assets/js/33.d951fe77.js"><link rel="prefetch" href="/assets/js/34.d3f94057.js"><link rel="prefetch" href="/assets/js/35.1ddffe8a.js"><link rel="prefetch" href="/assets/js/36.52bddbdc.js"><link rel="prefetch" href="/assets/js/37.22db3779.js"><link rel="prefetch" href="/assets/js/38.214de49f.js"><link rel="prefetch" href="/assets/js/39.a83709cc.js"><link rel="prefetch" href="/assets/js/6.ef9b23be.js"><link rel="prefetch" href="/assets/js/7.4eede40e.js"><link rel="prefetch" href="/assets/js/8.b9542584.js"><link rel="prefetch" href="/assets/js/9.15f840d6.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.5f196bb7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9d116826.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" style="background-image:url(https://img.yuicer.com//bg/winter.jpg),linear-gradient(#ccc 0%,#ccc 100%);background-attachment:fixed;background-position-x:50%;background-position-y:0%;background-blend-mode:multiply;background-repeat:no-repeat;background-size:cover;" data-v-7024d1ce data-v-ec218eb8><header class="navbar" data-v-7024d1ce><div class="sidebar"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true" class="icon"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg> <div class="pan"><div class="link-item"><a href="https://github.com/yuicer" target="_blank">github</a></div><div class="link-item"><a href="https://space.bilibili.com/3069623" target="_blank">B 站</a></div></div></div> <a href="/" class="home-link router-link-active"><div alt="yuicer" class="logo" style="background-image:url(https://img.yuicer.com/me.config/me.png);"></div> <span class="site-name can-hide">yuicer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></header> <div class="wrapper" data-v-7024d1ce><main class="page" data-v-7024d1ce data-v-ec218eb8> <div class="page-title" data-v-7024d1ce data-v-ec218eb8>Daily tip 03</div> <div class="tags" data-v-7024d1ce data-v-ec218eb8><div data-v-7024d1ce data-v-ec218eb8><span data-v-7024d1ce data-v-ec218eb8>砖头</span></div> <div class="time" data-v-7024d1ce data-v-ec218eb8><span data-v-7024d1ce data-v-ec218eb8>Nov 16  2021</span></div></div> <!----> <div class="theme-yuicer-content content__default" data-v-ec218eb8><h2 id="extends"><a href="#extends" class="header-anchor">#</a> extends</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>interface IOption {
  id: number;
}

interface IA&lt;T extends IOption&gt; {
  init:(option: T) =&gt; void;
}

interface IAOption extends IOption{
  a: number;
}

class A implements IA&lt;IOption&gt; {
  init(option: IOption){}
}

interface IB extends IA&lt;IAOption&gt; {
  init:(option: IAOption) =&gt; void;
}

class B extends A implements IB {
  init(option: IAOption){}
}


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="peer-dependencies"><a href="#peer-dependencies" class="header-anchor">#</a> peer dependencies</h2> <p>npm versions 1, 2, and 7 will automatically install peerDependencies if they are not explicitly depended upon higher in the dependency tree. For npm versions 3 through 6, you will receive a warning that the peerDependency is not installed instead.</p> <h2 id="app-link"><a href="#app-link" class="header-anchor">#</a> app link</h2> <ol><li>shema</li></ol> <p>when app installed, the app will add one custome protocol into ios system. like weixin://. But this method will be forbidened by some app and is not smooth enough</p> <ol><li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW1" target="_blank" rel="noopener noreferrer">Universal link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <p>iOS users can tap a link to your website and get seamlessly redirected to your installed app without going through Safari. If your app isn’t installed, tapping a link to your website opens your website in Safari.</p> <ul><li><p>Create an apple-app-site-association file that contains JSON data about the URLs that your app can handle.</p></li> <li><p>Upload the apple-app-site-association file to your HTTPS web server. You can place the file at the root of your server or in the .well-known subdirectory.</p></li> <li><p>Prepare your app to handle universal links.</p></li></ul> <h2 id="bisect"><a href="#bisect" class="header-anchor">#</a> bisect</h2> <p><code>git bisect start</code> can start a quick find for git commit<br> <code>git bisect bad/old</code> tag current commit as a bad code
<code>git bisect good/new commit-1</code> tag commit-1 commit as a good code</p> <p>and from now, git will automatical checkout to middle commit，and you need to tag good or bad untill you find the bug</p> <p><code>git bisect reset</code> will end this debug</p> <h2 id="_300ms-tap-delay"><a href="#_300ms-tap-delay" class="header-anchor">#</a> 300ms tap delay</h2> <p><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</code></p> <p><a href="https://developers.google.com/web/updates/2013/12/300ms-tap-delay-gone-away" target="_blank" rel="noopener noreferrer">detail<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="csp"><a href="#csp" class="header-anchor">#</a> CSP</h2> <p>https://developers.google.com/web/fundamentals/security/csp?hl=zh-cn</p> <p>only load code from specific uri</p> <p><code>script-src https://host1.com https://host2.com</code></p> <p>or with default-src</p> <p><code>Content-Security-Policy: default-src https://cdn.example.net; child-src 'none'; object-src 'none'</code></p> <p>at first, you can use <code>Content-Security-Policy-Report-Only</code></p> <p><code>script-src 'unsafe-eval'</code> will enabel evel Function
<code>script-src 'unsafe-inline'</code> will enabel inline script</p> <h2 id="ispointinstroke-ispointinpath"><a href="#ispointinstroke-ispointinpath" class="header-anchor">#</a> isPointInStroke isPointInPath</h2> <p>&quot;path&quot; will use close path (if path not close, it will use ctx.closePath automatically)</p> <p>&quot;stroke&quot; will detect the real pixel stroke</p> <iframe src="/demo/demo_211116/index.html" frameborder="no" marginwidth="0" marginheight="0" width="200" height="300"></iframe> <h2 id="npm-deprecate"><a href="#npm-deprecate" class="header-anchor">#</a> npm deprecate</h2> <p><a href="https://docs.npmjs.com/cli/v7/commands/npm-deprecate" target="_blank" rel="noopener noreferrer">deprecate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>to info users warning</p> <h2 id="lerna-skip-changed-check"><a href="#lerna-skip-changed-check" class="header-anchor">#</a> lerna skip changed check</h2> <p><code>--force-publish</code></p> <h2 id="mobile-browser-event-quene"><a href="#mobile-browser-event-quene" class="header-anchor">#</a> mobile browser event quene</h2> <p>touchstart touchend mousemove mousedoen mouseup click</p> <h2 id="git-delete-latest-tag"><a href="#git-delete-latest-tag" class="header-anchor">#</a> git delete latest tag</h2> <p><code>git tag -d $(git log --date-order --tags --simplify-by-decoration --pretty=format:'%d' | head -1 | tr -d '()' | sed 's/,* tag://g')</code></p> <h2 id="reset-first-git-commit"><a href="#reset-first-git-commit" class="header-anchor">#</a> reset first git commit</h2> <p><code>git update-ref -d HEAD</code> <a href="https://git-scm.com/docs/git-update-ref" target="_blank" rel="noopener noreferrer">update-ref<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>you need to delete current branch and push force again</p> <h2 id="git-delete-origin-tag"><a href="#git-delete-origin-tag" class="header-anchor">#</a> git delete origin tag</h2> <div class="language-s line-numbers-mode"><pre class="language-text"><code>git push origin --delete &lt;tagname&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="lerna-skip-partial-packages-using-leran-publish"><a href="#lerna-skip-partial-packages-using-leran-publish" class="header-anchor">#</a> lerna: skip partial packages using leran publish</h2> <p>lerna did support <code>lerna run xxx --scope pkg1</code>. but <code>scope</code> do not work when using <code>publish</code></p> <p>there has a lot of issues about this, but none of them mentioned how to solve it, cause the maintainer insist that</p> <blockquote><p>Because it breaks the fundamental mechanism Lerna uses to determine which packages need to be published? Absolutely nothing stopping you from not placing several packages in the same monorepo that apparently shouldn't be.<br>
------ @evocateur</p></blockquote> <blockquote><p>As I noted above, this is impossible due to the manner in which lerna coordinates versions with git tags (and the diff since the last one is what indicates which packages should be published).
------ @evocateur</p></blockquote> <blockquote><p>If they are both independent, and you don’t want to publish them at the same time, then don’t use lerna, it’s clearly not necessary for your use case.
------ @evocateur</p></blockquote> <p>until..... I fonud <a href="https://github.com/lerna/lerna/commit/a9b9f97457e4e4b0cac7f4ce562458d921a1f9be" target="_blank" rel="noopener noreferrer">this_commit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>I test the <code>lerna publish --no-private</code>, it did work for me on version 3.22.1</p> <p>but stil <code>lerna publish --help</code> did not show this config 😃</p> <h2 id="yarn-workspace-nohoist"><a href="#yarn-workspace-nohoist" class="header-anchor">#</a> yarn workspace nohoist</h2> <p><a href="https://classic.yarnpkg.com/blog/2018/02/15/nohoist/" target="_blank" rel="noopener noreferrer">doc_here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>workspaces looks good. but sometimes it's not so that smart. it juset can't completely figure out the package should place in the root node_modules or the child project node_modules</p> <p>so like the artificial intelligence, it need some help.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// root project package.json</span>
<span class="token string-property property">&quot;workspaces&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;./B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;nohoist&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;**/react-native&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// child project package.json</span>
<span class="token string-property property">&quot;workspaces&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;nohoist&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react-native&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-native/**&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="unhandledrejection"><a href="#unhandledrejection" class="header-anchor">#</a> unhandledRejection</h2> <p>In frontend project, sometimes, somehow, there will be somewhy error like <code>unhandledRejection</code></p> <p>but this error do not show where it is 😦</p> <p>so with the code below, you can catch them easily!</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'unhandledRejection'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Unhandled Rejection at: Promise'</span><span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token string">'reason:'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="disable-ds-store-auto-generated-in-mac"><a href="#disable-ds-store-auto-generated-in-mac" class="header-anchor">#</a> disable .ds_store auto generated in mac</h2> <p><a href="https://zh.wikipedia.org/zh-hans/.DS_Store" target="_blank" rel="noopener noreferrer">.DS_Store<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool TRUE</code></p> <h2 id="make-alias-with-zsh"><a href="#make-alias-with-zsh" class="header-anchor">#</a> make alias with zsh</h2> <p><code>alias [custom-alias]=&quot;[command]&quot;</code>
example
<code>alias devbox=&quot;ssh xxx@xx.xx.xx.xx&quot;</code></p> <h2 id="dyld-brew"><a href="#dyld-brew" class="header-anchor">#</a> dyld brew</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>dyld: Library not loaded: /usr/local/opt/icu4c/lib/libicui18n.64.dylib
  Referenced from: /usr/local/bin/node
  Reason: image not found
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>this problem is causing by error link node version. you can use <code>brew upgrade node</code> or <code>brew upgrade</code> to upgrade all packages.</p></div> <div class="page-nav" data-v-7024d1ce data-v-ec218eb8><p class="inner" data-v-7024d1ce data-v-ec218eb8><span class="prev" data-v-7024d1ce data-v-ec218eb8><a href="/daily-tip4/" class="prev" data-v-ec218eb8><span data-v-ec218eb8>←</span>
            Daily tip 04
          </a></span> <span class="next" data-v-7024d1ce data-v-ec218eb8><a href="/elephants/" class="next" data-v-ec218eb8>
            elephants
            <span data-v-ec218eb8>→</span></a></span></p></div> <!----> </main></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0958dc5d.js" defer></script><script src="/assets/js/4.5b843dec.js" defer></script><script src="/assets/js/5.4f7e8107.js" defer></script><script src="/assets/js/23.4e23238e.js" defer></script>
  </body>
</html>
